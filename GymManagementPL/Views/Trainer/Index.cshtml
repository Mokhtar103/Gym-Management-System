@model IEnumerable<GetAllTrainersVM>
@{
    ViewData["Title"] = "Trainers";
}




@if (TempData["SuccessMessage"] != null)
{
        <div id="Alert" class="alert alert-success alert-dismissible fade show">
            <i class="bi bi-check-circle-fill me-2"></i>
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

}
else if (TempData["ErrorMessage"] != null)
{
        <div id="Alert" class="alert alert-danger alert-dismissible fade show">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

}


    <div class="container">
        <header class="d-flex justify-content-between mt-5 mb-4 align-items-center">
            <div>
                <h2 class="text-primary-color mb-0">Our Trainers</h2>
                <p class="text-muted">Professional fitness instructors</p>
            </div>
            <a asp-controller="Trainer" asp-action="Create"
               class="btn btn-fill fw-medium rounded-pill px-4 py-3">
                <i class="bi bi-plus-lg me-2"></i>Add Trainer
            </a>
        </header>

            @if (Model != null && Model.Any())
            {
        <div class="table-responsive" style="overflow: visible;">
            <table class="table table-borderless">
                <thead>
                    <tr>
                        <th><span>@nameof(GetAllTrainersVM.Name)</span></th>
                        <th><span>@nameof(GetAllTrainersVM.Email)</span></th>
                        <th><span>@nameof(GetAllTrainersVM.Phone)</span></th>
                        <th><span>@nameof(GetAllTrainersVM.Specialities)</span></th>
                        <th><span>Action</span></th>
                    </tr>
                </thead>

                <tbody>
                @foreach(var trainer in Model)
                {
                        <tr>
                            <td><span class="fw-bold">@trainer.Name</span></td>
                            <td><span>@trainer.Email</span></td>
                            <td><span>@trainer.Phone</span></td>
                            <td>
                                <span class="badge bg-primary-color">@trainer.Specialities</span>
                            </td>
                            <td class="action position-relative">
                                <div class="dropdown">
                                    <button class="btn btn-link p-0 border-0" type="button"
                                            id="dropdownMenuButton-@trainer.Id" data-bs-toggle="dropdown"
                                            aria-expanded="false">
                                        <img src="./images/action dots.jpg" alt="action icon" />
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-start"
                                        aria-labelledby="dropdownMenuButton-@trainer.Id">
                                        <li>
                                            <a asp-controller="Trainer" asp-action="TrainerDetails" asp-route-Id="@trainer.Id"
                                               class="dropdown-item d-flex align-items-center gap-3">
                                                <i class="bi bi-eye text-primary-color"></i>
                                                <span>View Details</span>
                                            </a>
                                        </li>
                                        <li>
                                            <hr class="dropdown-divider">
                                        </li>
                                        <li>
                                            <a asp-controller="Trainer" asp-action="TrainerEdit" asp-route-Id="@trainer.Id"
                                               class="dropdown-item d-flex align-items-center gap-3">
                                                <i class="bi bi-pencil text-primary-color"></i>
                                                <span>Edit Details</span>
                                            </a>
                                        </li>
                                        <li>
                                            <hr class="dropdown-divider">
                                        </li>
                                        <li>
                                            @* <a asp-controller="Trainer" asp-action="TrainerDelete" asp-route-Id="@trainer.Id"
                                               class="dropdown-item d-flex align-items-center gap-3 text-danger">
                                                <i class="bi bi-trash"></i>
                                                <span>Delete</span>
                                            </a> *@

                                            <button type="button"
                                                    class="dropdown-item d-flex align-items-center gap-3 text-danger"
                                                    data-bs-toggle="modal"
                                                    data-bs-target="#deleteTrainerModal"
                                                    data-trainer-id="@trainer.Id">
                                                <img src="~/images/x-circle 1.jpg" alt="delete icon" style="width: 20px; height: 20px;" />
                                                <span>Delete</span>
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                        
                }
                </tbody>
            </table>
        </div>
        
            }
            else
            {
                  <div class="text-center py-5">
            <i class="bi bi-person-workspace display-1 text-muted"></i>
            <h4 class="mt-3 text-muted">No Trainers Available</h4>
            <p class="text-muted">Add your first trainer to get started</p>
        </div>

            }

      

    </div>



<div class="modal fade" id="deleteTrainerModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-4">
            <div class="modal-body text-center">
                <p class="fs-4 text-primary-color">
                    Are you sure you want to delete this trainer?
                </p>

                <div class="alert alert-warning text-start">
                    <strong>Warning!</strong> This action cannot be undone. All trainer data will be permanently deleted.
                </div>

                <form asp-controller="Trainer" asp-action="DeleteConfirmed" method="post">
                    <input type="hidden" readonly name="id" id="deleteTrainerId" />

                    <div class="d-flex justify-content-between gap-3 mt-4">
                        <button type="button" class="btn btn-outline-secondary flex-fill"
                                data-bs-dismiss="modal">
                            NO
                        </button>
                        <button type="submit" class="btn btn-danger flex-fill">
                            Yes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    var deleteModal = document.getElementById('deleteTrainerModal');
    deleteModal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget;
        var trainerId = button.getAttribute('data-Trainer-id');

        document.getElementById('deleteTrainerId').value = trainerId;
    });
</script>